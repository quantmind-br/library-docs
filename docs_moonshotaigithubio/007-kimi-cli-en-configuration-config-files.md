---
title: ""
url: https://moonshotai.github.io/kimi-cli/en/configuration/config-files.md
source: github_pages
fetched_at: 2026-01-28T07:56:19.872328514-03:00
rendered_js: false
word_count: 869
summary: A system instruction for extracting metadata from documents into a specific JSON structure including summary, tags, and category.
tags:
    - metadata
    - JSON
    - extraction
category: guide
---

--- url: /kimi-cli/en/configuration/config-files.md --- # Config Files Kimi Code CLI uses configuration files to manage API providers, models, services, and runtime parameters, supporting both TOML and JSON formats. ## Config file location The default configuration file is located at \`~/.kimi/config.toml\`. On first run, if the configuration file doesn't exist, Kimi Code CLI will automatically create a default configuration file. You can specify a different configuration file (TOML or JSON format) with the \`--config-file\` flag: \`\`\`sh kimi --config-file /path/to/config.toml \`\`\` When calling Kimi Code CLI programmatically, you can also pass the complete configuration content directly via the \`--config\` flag: \`\`\`sh kimi --config '{"default\_model": "kimi-for-coding", "providers": {...}, "models": {...}}' \`\`\` ## Config items The configuration file contains the following top-level configuration items: | Item | Type | Description | | --- | --- | --- | | \`default\_model\` | \`string\` | Default model name, must be a model defined in \`models\` | | \`default\_thinking\` | \`boolean\` | Whether to enable thinking mode by default (defaults to \`false\`) | | \`providers\` | \`table\` | API provider configuration | | \`models\` | \`table\` | Model configuration | | \`loop\_control\` | \`table\` | Agent loop control parameters | | \`services\` | \`table\` | External service configuration (search, fetch) | | \`mcp\` | \`table\` | MCP client configuration | ### Complete configuration example \`\`\`toml default\_model = "kimi-for-coding" default\_thinking = false \[providers.kimi-for-coding] type = "kimi" base\_url = "https://api.kimi.com/coding/v1" api\_key = "sk-xxx" \[models.kimi-for-coding] provider = "kimi-for-coding" model = "kimi-for-coding" max\_context\_size = 262144 \[loop\_control] max\_steps\_per\_turn = 100 max\_retries\_per\_step = 3 max\_ralph\_iterations = 0 reserved\_context\_size = 50000 \[services.moonshot\_search] base\_url = "https://api.kimi.com/coding/v1/search" api\_key = "sk-xxx" \[services.moonshot\_fetch] base\_url = "https://api.kimi.com/coding/v1/fetch" api\_key = "sk-xxx" \[mcp.client] tool\_call\_timeout\_ms = 60000 \`\`\` ### \`providers\` \`providers\` defines API provider connection information. Each provider uses a unique name as key. | Field | Type | Required | Description | | --- | --- | --- | --- | | \`type\` | \`string\` | Yes | Provider type, see \[Providers](./providers.md) for details | | \`base\_url\` | \`string\` | Yes | API base URL | | \`api\_key\` | \`string\` | Yes | API key | | \`env\` | \`table\` | No | Environment variables to set before creating provider instance | | \`custom\_headers\` | \`table\` | No | Custom HTTP headers to attach to requests | Example: \`\`\`toml \[providers.moonshot-cn] type = "kimi" base\_url = "https://api.moonshot.cn/v1" api\_key = "sk-xxx" custom\_headers = { "X-Custom-Header" = "value" } \`\`\` ### \`models\` \`models\` defines available models. Each model uses a unique name as key. | Field | Type | Required | Description | | --- | --- | --- | --- | | \`provider\` | \`string\` | Yes | Provider name to use, must be defined in \`providers\` | | \`model\` | \`string\` | Yes | Model identifier (model name used in API) | | \`max\_context\_size\` | \`integer\` | Yes | Maximum context length (in tokens) | | \`capabilities\` | \`array\` | No | Model capability list, see \[Providers](./providers.md#model-capabilities) for details | Example: \`\`\`toml \[models.kimi-k2-thinking-turbo] provider = "moonshot-cn" model = "kimi-k2-thinking-turbo" max\_context\_size = 262144 capabilities = \["thinking", "image\_in"] \`\`\` ### \`loop\_control\` \`loop\_control\` controls agent execution loop behavior. | Field | Type | Default | Description | | --- | --- | --- | --- | | \`max\_steps\_per\_turn\` | \`integer\` | \`100\` | Maximum steps per turn (alias: \`max\_steps\_per\_run\`) | | \`max\_retries\_per\_step\` | \`integer\` | \`3\` | Maximum retries per step | | \`max\_ralph\_iterations\` | \`integer\` | \`0\` | Extra iterations after each user message; \`0\` disables; \`-1\` is unlimited | | \`reserved\_context\_size\` | \`integer\` | \`50000\` | Reserved token count for LLM response generation; auto-compaction triggers when \`context\_tokens + reserved\_context\_size &gt;= max\_context\_size\` | ### \`services\` \`services\` configures external services used by Kimi Code CLI. #### \`moonshot\_search\` Configures web search service. When enabled, the \`SearchWeb\` tool becomes available. | Field | Type | Required | Description | | --- | --- | --- | --- | | \`base\_url\` | \`string\` | Yes | Search service API URL | | \`api\_key\` | \`string\` | Yes | API key | | \`custom\_headers\` | \`table\` | No | Custom HTTP headers to attach to requests | #### \`moonshot\_fetch\` Configures web fetch service. When enabled, the \`FetchURL\` tool prioritizes using this service to fetch webpage content. | Field | Type | Required | Description | | --- | --- | --- | --- | | \`base\_url\` | \`string\` | Yes | Fetch service API URL | | \`api\_key\` | \`string\` | Yes | API key | | \`custom\_headers\` | \`table\` | No | Custom HTTP headers to attach to requests | ::: tip When configuring the Kimi Code platform using the \`/setup\` command, search and fetch services are automatically configured. ::: ### \`mcp\` \`mcp\` configures MCP client behavior. | Field | Type | Default | Description | | --- | --- | --- | --- | | \`client.tool\_call\_timeout\_ms\` | \`integer\` | \`60000\` | MCP tool call timeout (milliseconds) | ## JSON configuration migration If \`~/.kimi/config.toml\` doesn't exist but \`~/.kimi/config.json\` exists, Kimi Code CLI will automatically migrate the JSON configuration to TOML format and backup the original file as \`config.json.bak\`. Configuration files specified via \`--config-file\` are parsed based on file extension. Configuration content passed via \`--config\` is first attempted as JSON, then falls back to TOML if that fails.